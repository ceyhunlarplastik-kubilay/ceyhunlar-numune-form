/* import config from "../config";
import { appRouter } from "./router";
import { publicBucket } from "./storage";

export const nextjs = new sst.aws.Nextjs("NumuneForm-Frontend", {
  path: "packages/next-app",
  // ...(['prod', 'dev'].includes($app.stage) && appRouter ? { router: { instance: appRouter } } : {}),
  ...(appRouter ? { router: { instance: appRouter } } : {}),
  link: [publicBucket],
  // Force webpack build for OpenNext v3.6.6 compatibility  
  buildCommand: "TURBOPACK=0 npm run build",
  environment: {
    STAGE: $app.stage,
    DOMAIN: config.DOMAIN,
    CLERK_SECRET_KEY: config.CLERK_SECRET_KEY,
    NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: config.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,
    GOOGLE_EMAIL: config.GOOGLE_EMAIL,
    GOOGLE_APP_PASSWORD: config.GOOGLE_APP_PASSWORD,
    GOOGLE_CLIENT_EMAIL: config.GOOGLE_CLIENT_EMAIL,
    GOOGLE_PRIVATE_KEY: config.GOOGLE_PRIVATE_KEY,
    MONGO_URI: config.MONGO_URI,
    SPREADSHEET_ID: config.SPREADSHEET_ID,

  },
}); */


import config from "../config";
import { publicBucket } from "./storage";
import { appRouter } from "./router";

export const frontend = new sst.aws.Nextjs("NumuneForm-Frontend", {
  path: "packages/frontend",

  // âœ… Router BURADA
  router: appRouter
    ? {
      instance: appRouter,
    }
    : undefined,

  link: [publicBucket],

  environment: {
    STAGE: $app.stage,
    DOMAIN: config.DOMAIN,
    CLERK_SECRET_KEY: config.CLERK_SECRET_KEY,
    NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY: config.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,
    GOOGLE_EMAIL: config.GOOGLE_EMAIL,
    GOOGLE_APP_PASSWORD: config.GOOGLE_APP_PASSWORD,
    GOOGLE_CLIENT_EMAIL: config.GOOGLE_CLIENT_EMAIL,
    GOOGLE_PRIVATE_KEY: config.GOOGLE_PRIVATE_KEY,
    MONGO_URI: config.MONGO_URI,
    SPREADSHEET_ID: config.SPREADSHEET_ID,
    NEXT_PUBLIC_BUCKET_NAME: publicBucket.name,
    TURKIYE_API_URL: config.TURKIYE_API_URL,
  },
});

